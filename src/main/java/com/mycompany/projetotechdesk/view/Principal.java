/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package com.mycompany.projetotechdesk.view;

import com.mycompany.projetotechdesk.Model.Cliente;
import com.mycompany.projetotechdesk.Model.Contato;
import com.mycompany.projetotechdesk.Model.Endereco;
import com.mycompany.projetotechdesk.Model.OrdemServico;
import com.mycompany.projetotechdesk.Model.Tecnico;
import com.mycompany.projetotechdesk.Model.Usuario;
import com.mycompany.projetotechdesk.dao.ClienteDAO;
import com.mycompany.projetotechdesk.dao.OrdemServicoDAO;
import com.mycompany.projetotechdesk.dao.TecnicoDAO;
import com.mycompany.projetotechdesk.database.Conexao;
import com.mycompany.projetotechdesk.util.RelatorioUtil;
import java.awt.BorderLayout;
import java.sql.Connection;
import java.sql.SQLException;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.function.Function;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.data.general.DefaultPieDataset;

/**
 *
 * @author carlo
 */
public class Principal extends javax.swing.JFrame {
    
    private static final java.util.logging.Logger logger = java.util.logging.Logger.getLogger(Principal.class.getName());

    /**
     * Creates new form Principal
     */
    public Principal() {
        this.setUndecorated(true);
        initComponents();
        this.setLocationRelativeTo(null); 
        this.setResizable(false); 
        
        
        atualizarTabelaOS();
        atualizarTabelaClientes();
        atualizarTabelaTecnico();
        atualizarRelatorios();
        gerarGraficoStatusOS();
        gerarGraficoValoresOS();
        
    }
    
    private Usuario usuarioLogado;
    private OrdemServicoDAO osDAO;
    private ClienteDAO clienteDAO;
    private TecnicoDAO tecnicoDAO;
    
    private List<Cliente> listaClientes = new ArrayList<>();
    private List<Tecnico> listaTecnicos = new ArrayList<>();
    
    private OrdemServico osSelecionada = null;
    private Cliente clienteSelecionado = null;
    private Tecnico tecnicoSelecionado = null;
    
    private double valorTotalOS = 0;
    private double valorPendenteOS = 0;

    
    
    private SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
    
    public Principal(Usuario usuario){
        this.setUndecorated(true);
        initComponents();
        this.setLocationRelativeTo(null); 
        this.setResizable(false); 
        
        this.usuarioLogado = usuario;
        
        //inicializa os DAOs
        this.osDAO = new OrdemServicoDAO();
        this.clienteDAO = new ClienteDAO();
        this.tecnicoDAO = new TecnicoDAO();
        
        aplicarPermissoes();
        
        //carrega os dados da aba de OS
        try{
            preencherCombosOS();
            atualizarTabelaOS();
            atualizarTabelaClientes();
            atualizarTabelaTecnico();
            atualizarRelatorios();
            gerarGraficoStatusOS();
            gerarGraficoValoresOS();
            
        } catch (Exception e){
            JOptionPane.showMessageDialog(this, "ERRO ao carregar dados: " + e.getMessage()); 
        }
        
        //define data de hoje no campo
        if (FtdDataEntradaOS != null) {
            FtdDataEntradaOS.setText(sdf.format(new Date()));
        }
    }
    
    

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        materialTableBeanInfo1 = new Componentes.MaterialTableBeanInfo();
        imagePanel1 = new Componentes.ImagePanel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        imagePanel2 = new Componentes.ImagePanel();
        roundedPanel1 = new Componentes.RoundedPanel();
        btnSalvarCliente = new Componentes.RoundedButton();
        txtNomeCliente = new Componentes.TextField();
        jLabel34 = new javax.swing.JLabel();
        txtEmailCliente = new Componentes.TextField();
        txtCpfCliente = new Componentes.TextField();
        btnEditarCliente = new Componentes.RoundedButton();
        btnExcluirCliente = new Componentes.RoundedButton();
        txtTelefoneCliente = new Componentes.TextField();
        iconButton1 = new Componentes.IconButton();
        jLabel11 = new javax.swing.JLabel();
        jLabel35 = new javax.swing.JLabel();
        roundedPanel8 = new Componentes.RoundedPanel();
        jLabel33 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblCliente = new javax.swing.JTable();
        imagePanel3 = new Componentes.ImagePanel();
        roundedPanel3 = new Componentes.RoundedPanel();
        btnSalvarTecnico = new Componentes.RoundedButton();
        btnEditarTecnico = new Componentes.RoundedButton();
        txtEmailTecnico = new Componentes.TextField();
        txtNomeTecnico = new Componentes.TextField();
        txtTelefoneTecnico = new Componentes.TextField();
        cbxEspecialidade = new javax.swing.JComboBox<>();
        btnExcluirTecnico = new Componentes.RoundedButton();
        jLabel6 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        pwdSenhaTecnico = new javax.swing.JPasswordField();
        iconButton3 = new Componentes.IconButton();
        roundedPanel6 = new Componentes.RoundedPanel();
        jLabel31 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblTecnico = new javax.swing.JTable();
        imagePanel4 = new Componentes.ImagePanel();
        roundedPanel5 = new Componentes.RoundedPanel();
        jLabel22 = new javax.swing.JLabel();
        cbxClienteOS = new javax.swing.JComboBox<>();
        jLabel23 = new javax.swing.JLabel();
        cbxTecnicoOS = new javax.swing.JComboBox<>();
        jLabel24 = new javax.swing.JLabel();
        jScrollPane5 = new javax.swing.JScrollPane();
        txaProblemaOS = new javax.swing.JTextArea();
        jLabel25 = new javax.swing.JLabel();
        cbxStatus = new javax.swing.JComboBox<>();
        jLabel26 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        FtdDataEntradaOS = new javax.swing.JFormattedTextField();
        ftdDataSaidaOS = new javax.swing.JFormattedTextField();
        jLabel28 = new javax.swing.JLabel();
        txtValorTotalOS = new Componentes.TextField();
        jLabel29 = new javax.swing.JLabel();
        txtValorPecasOS = new Componentes.TextField();
        jLabel30 = new javax.swing.JLabel();
        btnSalvarOS = new Componentes.RoundedButton();
        btnEditarOS = new Componentes.RoundedButton();
        btnExcluirOS = new Componentes.RoundedButton();
        txtValorMaoDeObraOS = new Componentes.TextField();
        jLabel36 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblRelatorioOS = new javax.swing.JTable();
        roundedPanel13 = new Componentes.RoundedPanel();
        jLabel32 = new javax.swing.JLabel();
        btnImprimir = new Componentes.RoundedButton();
        imagePanel6 = new Componentes.ImagePanel();
        roundedPanel2 = new Componentes.RoundedPanel();
        roundedPanel7 = new Componentes.RoundedPanel();
        jLabel14 = new javax.swing.JLabel();
        lblTotalAndamento = new javax.swing.JLabel();
        roundedPanel9 = new Componentes.RoundedPanel();
        jLabel15 = new javax.swing.JLabel();
        lblTotalAbertas = new javax.swing.JLabel();
        roundedPanel10 = new Componentes.RoundedPanel();
        jLabel16 = new javax.swing.JLabel();
        lblTotalConcluidas = new javax.swing.JLabel();
        roundedPanel11 = new Componentes.RoundedPanel();
        jLabel17 = new javax.swing.JLabel();
        lblValorTotal = new javax.swing.JLabel();
        roundedPanel12 = new Componentes.RoundedPanel();
        jLabel18 = new javax.swing.JLabel();
        lblValorPendente = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        panelGraficoTotalStatus = new javax.swing.JPanel();
        roundedPanel14 = new Componentes.RoundedPanel();
        jLabel19 = new javax.swing.JLabel();
        lblTotalCanceladas = new javax.swing.JLabel();
        panelGraficoTotalValor = new javax.swing.JPanel();
        btnFechar = new Componentes.IconButton();
        btnMinimizar = new Componentes.IconButton();
        btnSair = new Componentes.RoundedButton();
        jLabel8 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        imagePanel1.setBackground(new java.awt.Color(0, 102, 204));
        imagePanel1.setForeground(new java.awt.Color(0, 102, 204));

        jTabbedPane1.setBackground(new java.awt.Color(102, 153, 255));
        jTabbedPane1.setTabPlacement(javax.swing.JTabbedPane.LEFT);

        imagePanel2.setImageFile(new java.io.File("C:\\Users\\carlo\\Documents\\NetBeansProjects\\ProjetoTechDesk\\src\\main\\resources\\img\\fundo azul tecnico geral.jpg"));

        roundedPanel1.setShadowSize(5);

        btnSalvarCliente.setBackground(new java.awt.Color(0, 0, 204));
        btnSalvarCliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/salvar-branco.png"))); // NOI18N
        btnSalvarCliente.setText("Salvar");
        btnSalvarCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarClienteActionPerformed(evt);
            }
        });

        txtNomeCliente.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtNomeCliente.setForeground(new java.awt.Color(255, 255, 255));
        txtNomeCliente.setMinimumSize(new java.awt.Dimension(84, 32));
        txtNomeCliente.setPlaceholder("Nome Completo:");
        txtNomeCliente.setPreferredSize(new java.awt.Dimension(260, 35));

        jLabel34.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N

        txtEmailCliente.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtEmailCliente.setPlaceholder("Email");
        txtEmailCliente.setPreferredSize(new java.awt.Dimension(260, 32));

        txtCpfCliente.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtCpfCliente.setMinimumSize(new java.awt.Dimension(84, 35));
        txtCpfCliente.setPlaceholder("CPF");
        txtCpfCliente.setPreferredSize(new java.awt.Dimension(260, 32));

        btnEditarCliente.setBackground(new java.awt.Color(153, 153, 153));
        btnEditarCliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/editar-branco.png"))); // NOI18N
        btnEditarCliente.setText("Editar");
        btnEditarCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarClienteActionPerformed(evt);
            }
        });

        btnExcluirCliente.setBackground(new java.awt.Color(255, 102, 102));
        btnExcluirCliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/excluir-branco (2).png"))); // NOI18N
        btnExcluirCliente.setText("Excluir");
        btnExcluirCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirClienteActionPerformed(evt);
            }
        });

        txtTelefoneCliente.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtTelefoneCliente.setPlaceholder("Telefone");

        iconButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/contacto azul icon.png"))); // NOI18N
        iconButton1.setText("");

        jLabel11.setFont(new java.awt.Font("Yu Gothic UI Light", 1, 18)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(8, 118, 132));
        jLabel11.setText("Dados Pessoais");

        jLabel35.setFont(new java.awt.Font("Serif", 1, 24)); // NOI18N
        jLabel35.setForeground(new java.awt.Color(8, 118, 132));
        jLabel35.setText("Cadastrar Novo Cliente");

        javax.swing.GroupLayout roundedPanel1Layout = new javax.swing.GroupLayout(roundedPanel1);
        roundedPanel1.setLayout(roundedPanel1Layout);
        roundedPanel1Layout.setHorizontalGroup(
            roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel1Layout.createSequentialGroup()
                .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel1Layout.createSequentialGroup()
                        .addGap(19, 19, 19)
                        .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(roundedPanel1Layout.createSequentialGroup()
                                .addComponent(iconButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 144, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(roundedPanel1Layout.createSequentialGroup()
                                .addGap(407, 407, 407)
                                .addComponent(jLabel34, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addGroup(roundedPanel1Layout.createSequentialGroup()
                                    .addComponent(btnSalvarCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 116, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(btnEditarCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(btnExcluirCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(txtNomeCliente, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(txtEmailCliente, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel1Layout.createSequentialGroup()
                                        .addComponent(txtTelefoneCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(txtCpfCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 190, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                    .addGroup(roundedPanel1Layout.createSequentialGroup()
                        .addGap(107, 107, 107)
                        .addComponent(jLabel35, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        roundedPanel1Layout.setVerticalGroup(
            roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel35)
                .addGap(5, 5, 5)
                .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(iconButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jLabel11, javax.swing.GroupLayout.DEFAULT_SIZE, 34, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtNomeCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtEmailCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtTelefoneCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtCpfCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel1Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel34)
                        .addContainerGap())
                    .addGroup(roundedPanel1Layout.createSequentialGroup()
                        .addGap(39, 39, 39)
                        .addGroup(roundedPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(btnExcluirCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnEditarCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnSalvarCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );

        roundedPanel8.setShadowSize(5);

        jLabel33.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel33.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel33.setText("Clientes Cadastrados ");

        javax.swing.GroupLayout roundedPanel8Layout = new javax.swing.GroupLayout(roundedPanel8);
        roundedPanel8.setLayout(roundedPanel8Layout);
        roundedPanel8Layout.setHorizontalGroup(
            roundedPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel33, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        roundedPanel8Layout.setVerticalGroup(
            roundedPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel33, javax.swing.GroupLayout.DEFAULT_SIZE, 49, Short.MAX_VALUE)
        );

        tblCliente.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "ID", "Nome", "Telefone", "Email"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblCliente.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblClienteMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tblCliente);

        javax.swing.GroupLayout imagePanel2Layout = new javax.swing.GroupLayout(imagePanel2);
        imagePanel2.setLayout(imagePanel2Layout);
        imagePanel2Layout.setHorizontalGroup(
            imagePanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(roundedPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 462, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(imagePanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(roundedPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, 625, Short.MAX_VALUE)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 625, Short.MAX_VALUE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        imagePanel2Layout.setVerticalGroup(
            imagePanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(imagePanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(imagePanel2Layout.createSequentialGroup()
                        .addComponent(roundedPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(imagePanel2Layout.createSequentialGroup()
                        .addComponent(roundedPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 516, Short.MAX_VALUE)
                        .addGap(46, 46, 46))))
        );

        jTabbedPane1.addTab("Clientes", new javax.swing.ImageIcon("C:\\Users\\carlo\\Downloads\\cliente (1).png"), imagePanel2); // NOI18N

        imagePanel3.setImageFile(new java.io.File("C:\\Users\\carlo\\Documents\\NetBeansProjects\\ProjetoTechDesk\\src\\main\\resources\\img\\fundo azul tecnico geral.jpg"));

        roundedPanel3.setShadowSize(5);

        btnSalvarTecnico.setBackground(new java.awt.Color(0, 0, 204));
        btnSalvarTecnico.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/salvar-branco.png"))); // NOI18N
        btnSalvarTecnico.setText("Salvar");
        btnSalvarTecnico.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarTecnicoActionPerformed(evt);
            }
        });

        btnEditarTecnico.setBackground(new java.awt.Color(153, 153, 153));
        btnEditarTecnico.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/editar-branco.png"))); // NOI18N
        btnEditarTecnico.setText("Editar");
        btnEditarTecnico.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarTecnicoActionPerformed(evt);
            }
        });

        txtEmailTecnico.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtEmailTecnico.setPlaceholder("Email");

        txtNomeTecnico.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtNomeTecnico.setPlaceholder("Nome Completo");

        txtTelefoneTecnico.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        txtTelefoneTecnico.setPlaceholder("Telefone");

        cbxEspecialidade.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        cbxEspecialidade.setForeground(new java.awt.Color(153, 153, 153));
        cbxEspecialidade.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Especialidade", "Informática Geral", "​Notebooks e Laptops", "​Smartphones e Tablets", "​Eletrônica de Placa", "​Redes e Servidores", "​Impressoras", "​Consoles de Games", "​Recuperação de Dados", "​Apple Devices (Mac/iPhone)", "​Automação Comercial", "Outros" }));

        btnExcluirTecnico.setBackground(new java.awt.Color(255, 102, 102));
        btnExcluirTecnico.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/excluir-branco (2).png"))); // NOI18N
        btnExcluirTecnico.setText("Excluir");
        btnExcluirTecnico.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirTecnicoActionPerformed(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Serif", 1, 24)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(8, 118, 132));
        jLabel6.setText("Cadastrar Novo Técnico");

        jLabel4.setFont(new java.awt.Font("Yu Gothic UI Light", 1, 18)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(8, 118, 132));
        jLabel4.setText("Dados Pessoais");

        pwdSenhaTecnico.setToolTipText("");

        iconButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/contacto azul icon.png"))); // NOI18N
        iconButton3.setText("");

        javax.swing.GroupLayout roundedPanel3Layout = new javax.swing.GroupLayout(roundedPanel3);
        roundedPanel3.setLayout(roundedPanel3Layout);
        roundedPanel3Layout.setHorizontalGroup(
            roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel3Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel3Layout.createSequentialGroup()
                        .addComponent(iconButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 233, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addGroup(roundedPanel3Layout.createSequentialGroup()
                            .addComponent(btnSalvarTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(btnEditarTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(btnExcluirTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(txtEmailTecnico, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 409, Short.MAX_VALUE)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, roundedPanel3Layout.createSequentialGroup()
                                .addComponent(txtTelefoneTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(cbxEspecialidade, 0, 0, Short.MAX_VALUE))
                            .addComponent(txtNomeTecnico, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(pwdSenhaTecnico))))
                .addContainerGap(24, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel3Layout.createSequentialGroup()
                .addGap(0, 109, Short.MAX_VALUE)
                .addComponent(jLabel6)
                .addGap(96, 96, 96))
        );
        roundedPanel3Layout.setVerticalGroup(
            roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel6)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(iconButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtNomeTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtEmailTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtTelefoneTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbxEspecialidade, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pwdSenhaTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(38, 38, 38)
                .addGroup(roundedPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnExcluirTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnEditarTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSalvarTecnico, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(24, 24, 24))
        );

        roundedPanel6.setShadowSize(5);

        jLabel31.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel31.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel31.setText("Técnicos Cadastrados ");

        javax.swing.GroupLayout roundedPanel6Layout = new javax.swing.GroupLayout(roundedPanel6);
        roundedPanel6.setLayout(roundedPanel6Layout);
        roundedPanel6Layout.setHorizontalGroup(
            roundedPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel6Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addComponent(jLabel31, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        roundedPanel6Layout.setVerticalGroup(
            roundedPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel31, javax.swing.GroupLayout.DEFAULT_SIZE, 37, Short.MAX_VALUE)
                .addContainerGap())
        );

        tblTecnico.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "ID", "Nome", "Telefone", "Email", "Especialidade"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblTecnico.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblTecnicoMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tblTecnico);

        javax.swing.GroupLayout imagePanel3Layout = new javax.swing.GroupLayout(imagePanel3);
        imagePanel3.setLayout(imagePanel3Layout);
        imagePanel3Layout.setHorizontalGroup(
            imagePanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(roundedPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, 461, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(imagePanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(roundedPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, 654, Short.MAX_VALUE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 654, Short.MAX_VALUE))
                .addContainerGap())
        );
        imagePanel3Layout.setVerticalGroup(
            imagePanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(imagePanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(roundedPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, 345, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(imagePanel3Layout.createSequentialGroup()
                        .addComponent(roundedPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(122, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Técnicos", new javax.swing.ImageIcon("C:\\Users\\carlo\\Downloads\\suporte-tecnico (1).png"), imagePanel3); // NOI18N

        imagePanel4.setImageFile(new java.io.File("C:\\Users\\carlo\\Documents\\NetBeansProjects\\ProjetoTechDesk\\src\\main\\resources\\img\\fundo azul tecnico geral.jpg"));

        roundedPanel5.setShadowSize(5);

        jLabel22.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel22.setForeground(new java.awt.Color(8, 118, 132));
        jLabel22.setText("Cliente:");

        cbxClienteOS.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbxClienteOS.setToolTipText("Selecione um Cliente");

        jLabel23.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel23.setForeground(new java.awt.Color(8, 118, 132));
        jLabel23.setText("Técnico:");

        cbxTecnicoOS.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbxTecnicoOS.setToolTipText("Selecione um Técnico");

        jLabel24.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel24.setForeground(new java.awt.Color(8, 118, 132));
        jLabel24.setText("Descrição Do Problema:");

        txaProblemaOS.setColumns(20);
        txaProblemaOS.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        txaProblemaOS.setRows(5);
        jScrollPane5.setViewportView(txaProblemaOS);

        jLabel25.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel25.setForeground(new java.awt.Color(8, 118, 132));
        jLabel25.setText("Status:");

        cbxStatus.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Aberta", "Em Andamento", "Concluida", "Cancelada" }));
        cbxStatus.setToolTipText("Selecione o Status");

        jLabel26.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel26.setForeground(new java.awt.Color(8, 118, 132));
        jLabel26.setText("Data De Entrada:");

        jLabel27.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel27.setForeground(new java.awt.Color(8, 118, 132));
        jLabel27.setText("Data De Saida:");

        try {
            FtdDataEntradaOS.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        FtdDataEntradaOS.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N

        try {
            ftdDataSaidaOS.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("##/##/####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        ftdDataSaidaOS.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N

        jLabel28.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel28.setForeground(new java.awt.Color(8, 118, 132));
        jLabel28.setText("Valor Mão De Obra (R$):");

        txtValorTotalOS.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel29.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel29.setForeground(new java.awt.Color(8, 118, 132));
        jLabel29.setText("Peças (R$):");

        txtValorPecasOS.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel30.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel30.setForeground(new java.awt.Color(8, 118, 132));
        jLabel30.setText("Valor Total (R$):");

        btnSalvarOS.setBackground(new java.awt.Color(0, 0, 204));
        btnSalvarOS.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/salvar-branco.png"))); // NOI18N
        btnSalvarOS.setText("Salvar");
        btnSalvarOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarOSActionPerformed(evt);
            }
        });

        btnEditarOS.setBackground(new java.awt.Color(153, 153, 153));
        btnEditarOS.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/editar-branco.png"))); // NOI18N
        btnEditarOS.setText("Editar");
        btnEditarOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarOSActionPerformed(evt);
            }
        });

        btnExcluirOS.setBackground(new java.awt.Color(255, 102, 102));
        btnExcluirOS.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/excluir-branco (2).png"))); // NOI18N
        btnExcluirOS.setText("Excluir");
        btnExcluirOS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirOSActionPerformed(evt);
            }
        });

        txtValorMaoDeObraOS.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel36.setFont(new java.awt.Font("Serif", 1, 24)); // NOI18N
        jLabel36.setForeground(new java.awt.Color(8, 118, 132));
        jLabel36.setText("Cadastrar Nova Ordem de Serviço");

        javax.swing.GroupLayout roundedPanel5Layout = new javax.swing.GroupLayout(roundedPanel5);
        roundedPanel5.setLayout(roundedPanel5Layout);
        roundedPanel5Layout.setHorizontalGroup(
            roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel5Layout.createSequentialGroup()
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel5Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addGroup(roundedPanel5Layout.createSequentialGroup()
                                            .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 191, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGap(8, 8, 8))
                                        .addComponent(cbxClienteOS, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 199, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(24, 24, 24)
                                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(cbxTecnicoOS, javax.swing.GroupLayout.PREFERRED_SIZE, 189, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addComponent(jLabel30)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel5Layout.createSequentialGroup()
                                .addComponent(btnSalvarOS, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnEditarOS, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btnExcluirOS, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jScrollPane5)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel5Layout.createSequentialGroup()
                                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel5Layout.createSequentialGroup()
                                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                                .addGap(0, 0, Short.MAX_VALUE)
                                                .addComponent(jLabel28, javax.swing.GroupLayout.PREFERRED_SIZE, 205, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addGap(31, 31, 31))
                                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                                .addComponent(txtValorMaoDeObraOS, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                                                .addGap(44, 44, 44))
                                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                                .addComponent(txtValorTotalOS, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                                                .addGap(44, 44, 44)))
                                        .addGap(40, 40, 40)
                                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel26, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(FtdDataEntradaOS, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(cbxStatus, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel5Layout.createSequentialGroup()
                                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(txtValorPecasOS, javax.swing.GroupLayout.PREFERRED_SIZE, 199, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jLabel29, javax.swing.GroupLayout.PREFERRED_SIZE, 94, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jLabel27)
                                            .addComponent(ftdDataSaidaOS, javax.swing.GroupLayout.PREFERRED_SIZE, 132, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jLabel25, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                .addGap(9, 9, 9))))
                    .addGroup(roundedPanel5Layout.createSequentialGroup()
                        .addGap(49, 49, 49)
                        .addComponent(jLabel36)))
                .addContainerGap(19, Short.MAX_VALUE))
        );
        roundedPanel5Layout.setVerticalGroup(
            roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel5Layout.createSequentialGroup()
                .addGap(10, 10, 10)
                .addComponent(jLabel36)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel23, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel22, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cbxClienteOS, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cbxTecnicoOS, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel24, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel26, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel28, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel5Layout.createSequentialGroup()
                        .addComponent(txtValorMaoDeObraOS, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel29, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                .addComponent(txtValorPecasOS, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(roundedPanel5Layout.createSequentialGroup()
                                .addComponent(ftdDataSaidaOS, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel25, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addComponent(FtdDataEntradaOS, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(5, 5, 5)
                .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel5Layout.createSequentialGroup()
                        .addComponent(txtValorTotalOS, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(32, 32, 32)
                        .addGroup(roundedPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(btnEditarOS, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnExcluirOS, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnSalvarOS, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addComponent(cbxStatus, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(10, 10, 10))
        );

        btnEditarOS.getAccessibleContext().setAccessibleName("Excluir");
        btnExcluirOS.getAccessibleContext().setAccessibleName("Excluír");

        tblRelatorioOS.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null},
                {null, null, null, null, null}
            },
            new String [] {
                "ID", "Cliente", "Técnico", "Status", "Total"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(tblRelatorioOS);

        roundedPanel13.setShadowSize(5);

        jLabel32.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel32.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel32.setText("Ordens De Serviço Cadastradas");

        javax.swing.GroupLayout roundedPanel13Layout = new javax.swing.GroupLayout(roundedPanel13);
        roundedPanel13.setLayout(roundedPanel13Layout);
        roundedPanel13Layout.setHorizontalGroup(
            roundedPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel13Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addComponent(jLabel32, javax.swing.GroupLayout.DEFAULT_SIZE, 592, Short.MAX_VALUE)
                .addContainerGap())
        );
        roundedPanel13Layout.setVerticalGroup(
            roundedPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel32, javax.swing.GroupLayout.DEFAULT_SIZE, 37, Short.MAX_VALUE)
                .addContainerGap())
        );

        btnImprimir.setText("Imprimir");
        btnImprimir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnImprimirActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout imagePanel4Layout = new javax.swing.GroupLayout(imagePanel4);
        imagePanel4.setLayout(imagePanel4Layout);
        imagePanel4Layout.setHorizontalGroup(
            imagePanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel4Layout.createSequentialGroup()
                .addGroup(imagePanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnImprimir, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(imagePanel4Layout.createSequentialGroup()
                        .addComponent(roundedPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 459, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(imagePanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 625, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, 624, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(37, Short.MAX_VALUE))
        );
        imagePanel4Layout.setVerticalGroup(
            imagePanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(imagePanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(imagePanel4Layout.createSequentialGroup()
                        .addComponent(roundedPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 520, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnImprimir, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(8, 8, 8))
                    .addGroup(imagePanel4Layout.createSequentialGroup()
                        .addComponent(roundedPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, 627, Short.MAX_VALUE)
                        .addContainerGap())))
        );

        jTabbedPane1.addTab("Ordens De Serviço", new javax.swing.ImageIcon("C:\\Users\\carlo\\Downloads\\servico-de-gestao.png"), imagePanel4); // NOI18N

        imagePanel6.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED, new java.awt.Color(153, 153, 153), new java.awt.Color(153, 153, 153), new java.awt.Color(153, 153, 153), new java.awt.Color(153, 153, 153)));
        imagePanel6.setAlignmentX(0.0F);
        imagePanel6.setAlignmentY(0.0F);
        imagePanel6.setImageFile(new java.io.File("C:\\Users\\carlo\\Pictures\\trabalho final\\fundo azul certoo.jpg"));
        imagePanel6.setResourcePath("<Not Set>");
        imagePanel6.setScaleType(Componentes.ImagePanel.ScaleType.CENTER);

        roundedPanel2.setBackground(new java.awt.Color(245, 246, 250));
        roundedPanel2.setShadowSize(5);

        roundedPanel7.setBackground(new java.awt.Color(255, 204, 0));
        roundedPanel7.setShadowSize(5);

        jLabel14.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(255, 255, 255));
        jLabel14.setText("O.S Em Andamento");

        lblTotalAndamento.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblTotalAndamento.setForeground(new java.awt.Color(255, 255, 255));
        lblTotalAndamento.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTotalAndamento.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(204, 204, 0)));

        javax.swing.GroupLayout roundedPanel7Layout = new javax.swing.GroupLayout(roundedPanel7);
        roundedPanel7.setLayout(roundedPanel7Layout);
        roundedPanel7Layout.setHorizontalGroup(
            roundedPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel7Layout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addGroup(roundedPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel7Layout.createSequentialGroup()
                        .addComponent(lblTotalAndamento, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 9, Short.MAX_VALUE))
                    .addComponent(jLabel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        roundedPanel7Layout.setVerticalGroup(
            roundedPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel7Layout.createSequentialGroup()
                .addGap(12, 12, 12)
                .addComponent(jLabel14)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblTotalAndamento, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addContainerGap())
        );

        roundedPanel9.setBackground(new java.awt.Color(51, 51, 255));
        roundedPanel9.setShadowSize(5);

        jLabel15.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel15.setForeground(new java.awt.Color(255, 255, 255));
        jLabel15.setText("O.S Em Aberto");

        lblTotalAbertas.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblTotalAbertas.setForeground(new java.awt.Color(255, 255, 255));
        lblTotalAbertas.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTotalAbertas.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(204, 204, 0)));

        javax.swing.GroupLayout roundedPanel9Layout = new javax.swing.GroupLayout(roundedPanel9);
        roundedPanel9.setLayout(roundedPanel9Layout);
        roundedPanel9Layout.setHorizontalGroup(
            roundedPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel9Layout.createSequentialGroup()
                .addGap(12, 12, 12)
                .addGroup(roundedPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTotalAbertas, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(18, Short.MAX_VALUE))
        );
        roundedPanel9Layout.setVerticalGroup(
            roundedPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel15)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblTotalAbertas, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addGap(12, 12, 12))
        );

        roundedPanel10.setBackground(new java.awt.Color(0, 204, 0));
        roundedPanel10.setShadowSize(5);

        jLabel16.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel16.setForeground(new java.awt.Color(255, 255, 255));
        jLabel16.setText("O.S Concluidas");

        lblTotalConcluidas.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblTotalConcluidas.setForeground(new java.awt.Color(255, 255, 255));
        lblTotalConcluidas.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTotalConcluidas.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(204, 204, 0)));

        javax.swing.GroupLayout roundedPanel10Layout = new javax.swing.GroupLayout(roundedPanel10);
        roundedPanel10.setLayout(roundedPanel10Layout);
        roundedPanel10Layout.setHorizontalGroup(
            roundedPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel10Layout.createSequentialGroup()
                .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 41, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(lblTotalConcluidas, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(14, 14, 14))
        );
        roundedPanel10Layout.setVerticalGroup(
            roundedPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel16)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblTotalConcluidas, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addGap(12, 12, 12))
        );

        roundedPanel11.setBackground(new java.awt.Color(255, 153, 51));
        roundedPanel11.setForeground(new java.awt.Color(153, 102, 255));
        roundedPanel11.setShadowSize(5);

        jLabel17.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel17.setForeground(new java.awt.Color(255, 255, 255));
        jLabel17.setText("Valor Total Das O.S");

        lblValorTotal.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblValorTotal.setForeground(new java.awt.Color(255, 255, 255));
        lblValorTotal.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblValorTotal.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(255, 51, 51)));

        javax.swing.GroupLayout roundedPanel11Layout = new javax.swing.GroupLayout(roundedPanel11);
        roundedPanel11.setLayout(roundedPanel11Layout);
        roundedPanel11Layout.setHorizontalGroup(
            roundedPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel11Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(roundedPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblValorTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 181, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(7, Short.MAX_VALUE))
        );
        roundedPanel11Layout.setVerticalGroup(
            roundedPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(lblValorTotal, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addContainerGap())
        );

        roundedPanel12.setBackground(new java.awt.Color(204, 51, 255));
        roundedPanel12.setShadowSize(5);

        jLabel18.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(255, 255, 255));
        jLabel18.setText("Valor Pendentes");

        lblValorPendente.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblValorPendente.setForeground(new java.awt.Color(255, 255, 255));
        lblValorPendente.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblValorPendente.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(255, 51, 51)));

        javax.swing.GroupLayout roundedPanel12Layout = new javax.swing.GroupLayout(roundedPanel12);
        roundedPanel12.setLayout(roundedPanel12Layout);
        roundedPanel12Layout.setHorizontalGroup(
            roundedPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel12Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(roundedPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(lblValorPendente, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 166, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(16, Short.MAX_VALUE))
        );
        roundedPanel12Layout.setVerticalGroup(
            roundedPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(lblValorPendente, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addContainerGap())
        );

        jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 21)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(102, 102, 102));
        jLabel7.setText("Relatório Mensal de Ordens de Serviço");

        javax.swing.GroupLayout panelGraficoTotalStatusLayout = new javax.swing.GroupLayout(panelGraficoTotalStatus);
        panelGraficoTotalStatus.setLayout(panelGraficoTotalStatusLayout);
        panelGraficoTotalStatusLayout.setHorizontalGroup(
            panelGraficoTotalStatusLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 322, Short.MAX_VALUE)
        );
        panelGraficoTotalStatusLayout.setVerticalGroup(
            panelGraficoTotalStatusLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 302, Short.MAX_VALUE)
        );

        roundedPanel14.setBackground(new java.awt.Color(204, 51, 0));
        roundedPanel14.setShadowSize(5);

        jLabel19.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel19.setForeground(new java.awt.Color(255, 255, 255));
        jLabel19.setText("O.S Canceladas");

        lblTotalCanceladas.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
        lblTotalCanceladas.setForeground(new java.awt.Color(255, 255, 255));
        lblTotalCanceladas.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblTotalCanceladas.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(204, 204, 0)));

        javax.swing.GroupLayout roundedPanel14Layout = new javax.swing.GroupLayout(roundedPanel14);
        roundedPanel14.setLayout(roundedPanel14Layout);
        roundedPanel14Layout.setHorizontalGroup(
            roundedPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel14Layout.createSequentialGroup()
                .addGap(12, 12, 12)
                .addGroup(roundedPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel19, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblTotalCanceladas, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(18, Short.MAX_VALUE))
        );
        roundedPanel14Layout.setVerticalGroup(
            roundedPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel14Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel19)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblTotalCanceladas, javax.swing.GroupLayout.DEFAULT_SIZE, 107, Short.MAX_VALUE)
                .addGap(12, 12, 12))
        );

        javax.swing.GroupLayout panelGraficoTotalValorLayout = new javax.swing.GroupLayout(panelGraficoTotalValor);
        panelGraficoTotalValor.setLayout(panelGraficoTotalValorLayout);
        panelGraficoTotalValorLayout.setHorizontalGroup(
            panelGraficoTotalValorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        panelGraficoTotalValorLayout.setVerticalGroup(
            panelGraficoTotalValorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 290, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout roundedPanel2Layout = new javax.swing.GroupLayout(roundedPanel2);
        roundedPanel2.setLayout(roundedPanel2Layout);
        roundedPanel2Layout.setHorizontalGroup(
            roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel2Layout.createSequentialGroup()
                .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel2Layout.createSequentialGroup()
                        .addGap(36, 36, 36)
                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 424, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(roundedPanel2Layout.createSequentialGroup()
                        .addGap(27, 27, 27)
                        .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(roundedPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(roundedPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(163, 163, 163)
                .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(panelGraficoTotalStatus, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(panelGraficoTotalValor, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(163, Short.MAX_VALUE))
        );
        roundedPanel2Layout.setVerticalGroup(
            roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(roundedPanel2Layout.createSequentialGroup()
                .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(roundedPanel2Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 52, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(roundedPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(roundedPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(roundedPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel2Layout.createSequentialGroup()
                                .addComponent(roundedPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(roundedPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, roundedPanel2Layout.createSequentialGroup()
                                .addComponent(roundedPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(roundedPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(roundedPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(panelGraficoTotalStatus, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(panelGraficoTotalValor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout imagePanel6Layout = new javax.swing.GroupLayout(imagePanel6);
        imagePanel6.setLayout(imagePanel6Layout);
        imagePanel6Layout.setHorizontalGroup(
            imagePanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(roundedPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, 1127, Short.MAX_VALUE)
        );
        imagePanel6Layout.setVerticalGroup(
            imagePanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, imagePanel6Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(roundedPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, 620, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jTabbedPane1.addTab("Financeiro", new javax.swing.ImageIcon(getClass().getResource("/img/dinheiro.png")), imagePanel6); // NOI18N
        imagePanel6.getAccessibleContext().setAccessibleName("Relatório O.S");

        btnFechar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/cancelar (1).png"))); // NOI18N
        btnFechar.setText("\n");
        btnFechar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFecharActionPerformed(evt);
            }
        });

        btnMinimizar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/minimize-o-sinal.png"))); // NOI18N
        btnMinimizar.setText("");
        btnMinimizar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMinimizarActionPerformed(evt);
            }
        });

        btnSair.setBackground(new java.awt.Color(0, 0, 255));
        btnSair.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/sair.png"))); // NOI18N
        btnSair.setText("Sair");
        btnSair.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        btnSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSairActionPerformed(evt);
            }
        });

        jLabel8.setFont(new java.awt.Font("Monospaced", 0, 24)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(255, 255, 255));
        jLabel8.setText("Bem-Vindo ao TechDesk");

        javax.swing.GroupLayout imagePanel1Layout = new javax.swing.GroupLayout(imagePanel1);
        imagePanel1.setLayout(imagePanel1Layout);
        imagePanel1Layout.setHorizontalGroup(
            imagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(imagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(imagePanel1Layout.createSequentialGroup()
                        .addComponent(jTabbedPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 1288, Short.MAX_VALUE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(imagePanel1Layout.createSequentialGroup()
                        .addComponent(btnSair, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(94, 94, 94)
                        .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 384, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnMinimizar, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(btnFechar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(9, 9, 9))))
        );
        imagePanel1Layout.setVerticalGroup(
            imagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(imagePanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(imagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(imagePanel1Layout.createSequentialGroup()
                        .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 645, Short.MAX_VALUE))
                    .addGroup(imagePanel1Layout.createSequentialGroup()
                        .addGroup(imagePanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(btnFechar, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnSair, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnMinimizar, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jTabbedPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 639, Short.MAX_VALUE)))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(imagePanel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(imagePanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnMinimizarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMinimizarActionPerformed
        this.setState(javax.swing.JFrame.ICONIFIED);
    }//GEN-LAST:event_btnMinimizarActionPerformed

    private void btnSairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSairActionPerformed
        this.dispose();
        new Login().setVisible(true);
    }//GEN-LAST:event_btnSairActionPerformed

    private void btnFecharActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFecharActionPerformed
        this.dispose();
    }//GEN-LAST:event_btnFecharActionPerformed

    private void btnExcluirOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirOSActionPerformed
        int linha = tblRelatorioOS.getSelectedRow();
        if (linha == -1) {
            JOptionPane.showMessageDialog(this, "Selecione para excluir.");
            return;
        }

        int idOS = (int) tblRelatorioOS.getValueAt(linha, 0);

        int confirm = JOptionPane.showConfirmDialog(this, "Excluir O.S. " + idOS + "?");
        if (confirm == JOptionPane.YES_OPTION) {
            try {
                osDAO.excluir(idOS, usuarioLogado.getEmpresa().getId());
                atualizarTabelaOS();
                limparFormulariosOS(); 
                atualizarRelatorios();
                gerarGraficoStatusOS();
                gerarGraficoValoresOS();
                JOptionPane.showMessageDialog(this, "Excluido.");
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, "ERRO: " + e.getMessage());
            }
        }
    }//GEN-LAST:event_btnExcluirOSActionPerformed

    private void btnEditarOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarOSActionPerformed
        int linha = tblRelatorioOS.getSelectedRow();
        if (linha == -1){
            JOptionPane.showMessageDialog(this, "Selecione uma O.S. para editar.");
            return;
        }

        try {
            // Pega o ID da tabela
            int idOS = (int) tblRelatorioOS.getValueAt(linha, 0);

            // RECARREGA A LISTA
            List<OrdemServico> listaTemp = osDAO.listarTabelaOS(usuarioLogado.getEmpresa().getId());

            for(OrdemServico os : listaTemp) {
                if(os.getId() == idOS) {
                    osSelecionada = os;
                    break;
                }
            }

            if(osSelecionada == null) return;

            //  PREENCHE OS CAMPOS

            txtValorMaoDeObraOS.setText(String.valueOf(osSelecionada.getValorMaoObra()).replace(".", ","));
            txtValorPecasOS.setText(String.valueOf(osSelecionada.getValorPecas()).replace(".", ","));

            if (txtValorTotalOS != null) {
                txtValorTotalOS.setText(String.valueOf(osSelecionada.getValorTotal()).replace(".", ","));
            }

            txaProblemaOS.setText(osSelecionada.getDescricaoProblema());
            cbxStatus.setSelectedItem(osSelecionada.getStatus());

            // Datas
            if(osSelecionada.getDataEntrada() != null)
            FtdDataEntradaOS.setText(sdf.format(osSelecionada.getDataEntrada()));

            if(osSelecionada.getDataSaida() != null)
            ftdDataSaidaOS.setText(sdf.format(osSelecionada.getDataSaida()));

            // Cliente
            for(int i=0; i<cbxClienteOS.getItemCount(); i++){
                Cliente c = (Cliente) cbxClienteOS.getItemAt(i);
                if(c.getId() == osSelecionada.getCliente().getId()){
                    cbxClienteOS.setSelectedIndex(i);
                    break;
                }
            }

            // Técnico
            if(osSelecionada.getTecnico() != null){
                for(int i=0; i<cbxTecnicoOS.getItemCount(); i++){
                    Object item = cbxTecnicoOS.getItemAt(i);
                    if(item != null && ((Tecnico)item).getId() == osSelecionada.getTecnico().getId()){
                        cbxTecnicoOS.setSelectedIndex(i);
                        break;
                    }
                }
            } else {
                cbxTecnicoOS.setSelectedItem(null);
            }

            btnSalvarOS.setText("Atualizar");
            JOptionPane.showMessageDialog(this, "Modo Edição Ativado.");

        } catch(Exception e) {
            JOptionPane.showMessageDialog(this, "Erro ao editar: " + e.getMessage());
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnEditarOSActionPerformed

    private void btnSalvarOSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarOSActionPerformed

        try {
            if (cbxClienteOS.getSelectedItem() == null) {
                JOptionPane.showMessageDialog(this, "Selecione um Cliente.");
                return;
            }

            OrdemServico os = new OrdemServico();
            if (osSelecionada != null) os.setId(osSelecionada.getId());

            os.setEmpresa(usuarioLogado.getEmpresa());
            os.setCliente((Cliente) cbxClienteOS.getSelectedItem());
            os.setTecnico((Tecnico) cbxTecnicoOS.getSelectedItem());
            os.setStatus((String) cbxStatus.getSelectedItem());

            os.setDescricaoProblema(txaProblemaOS.getText());

            try {
                os.setDataEntrada(sdf.parse(FtdDataEntradaOS.getText()));
                String saida = ftdDataSaidaOS.getText().trim();
                if (!saida.isEmpty() && !saida.equals("/ /")) {
                    os.setDataSaida(sdf.parse(saida));
                }
            } catch (Exception e) {
                os.setDataEntrada(new Date());
            }

            String mao = txtValorMaoDeObraOS.getText().replace(",", ".");
            String pecas = txtValorPecasOS.getText().replace(",", ".");
            os.setValorMaoObra(Double.parseDouble(mao.isEmpty() ? "0" : mao));
            os.setValorPecas(Double.parseDouble(pecas.isEmpty() ? "0" : pecas));

            if (osSelecionada == null) {
                osDAO.adicionar(os);
                JOptionPane.showMessageDialog(this, "O.S. criada!");
            } else {
                osDAO.atualizar(os);
                JOptionPane.showMessageDialog(this, "O.S. atualizada!");
            }

            limparFormulariosOS();
            atualizarTabelaOS();
            atualizarRelatorios();
            gerarGraficoStatusOS();
            gerarGraficoValoresOS();

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "ERRO: " + e.getMessage());
        }
    }//GEN-LAST:event_btnSalvarOSActionPerformed

    private void tblTecnicoMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblTecnicoMouseClicked
        if (evt.getClickCount() == 2) {
            int linha = tblTecnico.getSelectedRow();
            if (linha == -1) return;

            try {
                // Pega o ID e Nome da linha selecionada
                
                int id = (int) tblTecnico.getValueAt(linha, 0);
                String nome = (String) tblTecnico.getValueAt(linha, 1);

                // Abre a tela de endereços passando o ID e dizendo que é CLIENTE/tecnico
                new TelaEndereco(id, "TECNICO", nome).setVisible(true);

            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }//GEN-LAST:event_tblTecnicoMouseClicked

    private void btnExcluirTecnicoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirTecnicoActionPerformed
       int linha = tblTecnico.getSelectedRow();
        if (linha == -1){
            JOptionPane.showMessageDialog(this, "Selecione para excluir");
            return;
        }

        //pega o id direto da tabela (coluna 0)
        int idTecnico = 0;
        String nomeTecnico = "";

        try {
            if (!listaTecnicos.isEmpty() && linha < listaTecnicos.size()){
                idTecnico = listaTecnicos.get(linha).getId();
                nomeTecnico = listaTecnicos.get(linha).getNome();
            } else {
                idTecnico = (int) tblTecnico.getValueAt(linha, 0);
                nomeTecnico = (String) tblTecnico.getValueAt(linha, 1);
            }
        } catch(Exception e){
            idTecnico = (int) tblTecnico.getValueAt(linha, 0);
        }

        int confirm = JOptionPane.showConfirmDialog(this, "Tem certeza que deseja excluir esse técnico " + nomeTecnico + "?\nIsso apagaá também o ACESSO DE LOGIN dele.",
            "CONFIRMAÇÂO", JOptionPane.YES_NO_OPTION);

        if (confirm == JOptionPane.YES_OPTION) {
            try{
                tecnicoDAO.excluir(idTecnico, usuarioLogado.getEmpresa().getId());

                atualizarTabelaTecnico();
                preencherCombosOS();
                limparFormularioTecnico();
                

                JOptionPane.showMessageDialog(this, "Excluido com sucesso");

            } catch (SQLException e) {
                JOptionPane.showMessageDialog(this,
                    "Nao foi possivel excluir:\n" + e.getMessage(),
                    "Aviso",
                    JOptionPane.WARNING_MESSAGE);
            } catch (Exception e){
                JOptionPane.showMessageDialog(this, "ERRO ao excluir: " + e.getMessage());
            }
        }
    }//GEN-LAST:event_btnExcluirTecnicoActionPerformed

    private void btnEditarTecnicoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarTecnicoActionPerformed
        int linha = tblTecnico.getSelectedRow();
        if (linha == -1) {
            JOptionPane.showMessageDialog(this, "Selecione um Tecnico para editar.");
            return;
        }

        //recupera o objeto completo da lista em memória
        try {
            tecnicoSelecionado =listaTecnicos.get(linha);

            //Preencher a tela
            txtNomeTecnico.setText(tecnicoSelecionado.getNome());

            if(txtTelefoneTecnico != null) txtTelefoneTecnico.setText("");

            cbxEspecialidade.setSelectedItem(tecnicoSelecionado.getEspecialidade());

            // Contato
            txtEmailTecnico.setText(tecnicoSelecionado.getContato().getEmail());
            txtTelefoneTecnico.setText(tecnicoSelecionado.getContato().getTelefone());

            //muda texto do botão
            btnSalvarTecnico.setText("Atualizar");

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Erro ao carregar dados: " + e.getMessage());

        }
    }//GEN-LAST:event_btnEditarTecnicoActionPerformed

    private void btnSalvarTecnicoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarTecnicoActionPerformed
        try {
            //validaçao dos itens obrigatorios
            if (txtNomeTecnico.getText().trim().isEmpty() ||
                txtEmailTecnico.getText().trim().isEmpty()) {

                JOptionPane.showMessageDialog(this,
                    "Preencha os campos obrigatórios:\n- Nome\n- Email",
                    "Campos Obrigatórios",
                    JOptionPane.WARNING_MESSAGE);
                return; // Para a execução aqui se faltar algo
            }

            if (cbxEspecialidade.getSelectedIndex() <= 0) {
                JOptionPane.showMessageDialog(this, "Selecione uma Especialidade.", "Aviso", JOptionPane.WARNING_MESSAGE);
                return;
            }

            //validação da senha
            String senha = "";
            if (pwdSenhaTecnico != null) {
                senha = new String(pwdSenhaTecnico.getPassword());
            }

            // Se for NOVO cadastro, senha é obrigatória
            if (tecnicoSelecionado == null && senha.trim().isEmpty()) {
                JOptionPane.showMessageDialog(this, "Defina uma senha para o login do técnico.", "Senha Obrigatória", JOptionPane.WARNING_MESSAGE);
                return;
            }

            //prepara os objetos
            Tecnico tecnico = new Tecnico();
            Contato contato = new Contato();
            

            //se for edição, recupera IDs
            if (tecnicoSelecionado != null) {
                tecnico.setId(tecnicoSelecionado.getId());
                contato.setId(tecnicoSelecionado.getContato().getId());
                
            }

            //dados do tecnico
            tecnico.setEmpresa(usuarioLogado.getEmpresa());
            tecnico.setNome(txtNomeTecnico.getText());
            tecnico.setEspecialidade(cbxEspecialidade.getSelectedItem() != null ? cbxEspecialidade.getSelectedItem().toString() : "");

            //Dados do contato
            contato.setEmail(txtEmailTecnico.getText());
            contato.setTelefone(txtTelefoneTecnico.getText());
            tecnico.setContato(contato);            

            //Salva no Banco
            if (tecnicoSelecionado == null) {
                // ADICIONAR
                tecnicoDAO.adicionar(tecnico, senha, usuarioLogado.getEmpresa().getId());
                JOptionPane.showMessageDialog(this, "Técnico cadastrado!");
            } else {
                // ATUALIZAR - AGORA PASSANDO A SENHA!
                // Se a senha estiver vazia (usuário não digitou nada), o DAO envia vazio e o Banco mantém a antiga.
                tecnicoDAO.atualizar(tecnico, senha);
                JOptionPane.showMessageDialog(this, "Técnico atualizado!");
            }

            //limpa e atualiza
            limparFormularioTecnico();
            atualizarTabelaTecnico();
            preencherCombosOS();

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "ERRO ao salvar: " + e.getMessage());
            e.printStackTrace();
        }
    }//GEN-LAST:event_btnSalvarTecnicoActionPerformed

    private void tblClienteMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblClienteMouseClicked
        if (evt.getClickCount() == 2) {
            int linha = tblCliente.getSelectedRow();
            if (linha == -1) return;

            try {
                // Pega o ID e Nome da linha selecionada
                // (Certifique-se que a coluna 0 é o ID e a 1 é o Nome)
                int id = (int) tblCliente.getValueAt(linha, 0);
                String nome = (String) tblCliente.getValueAt(linha, 1);

                // Abre a tela de endereços passando o ID e dizendo que é CLIENTE
                new TelaEndereco(id, "CLIENTE", nome).setVisible(true);

            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }//GEN-LAST:event_tblClienteMouseClicked

    private void btnExcluirClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirClienteActionPerformed
        int linha = tblCliente.getSelectedRow();
        if(linha == -1) return;

        int id = (int) tblCliente.getValueAt(linha, 0); // ID da coluna 0

        int confirm = JOptionPane.showConfirmDialog(this, "Excluir Cliente? Todos os endereços dele também serão apagados.", "Excluir", JOptionPane.YES_NO_OPTION);

        if (confirm == JOptionPane.YES_OPTION) {
            try {
                clienteDAO.excluir(id, usuarioLogado.getEmpresa().getId());
                atualizarTabelaClientes();
                preencherCombosOS();
                limparFormularioCliente();
                JOptionPane.showMessageDialog(this, "Cliente e seus endereços excluídos.");
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, "ERRO: " + e.getMessage());
            }
        }
    }//GEN-LAST:event_btnExcluirClienteActionPerformed

    private void btnEditarClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarClienteActionPerformed
        int linha = tblCliente.getSelectedRow();
        if (linha == -1) {
            JOptionPane.showMessageDialog(this, "Selecione um Cliente.");
            return;
        }

        try {
            int idCliente = (int) tblCliente.getValueAt(linha, 0);

            ClienteDAO clienteDAO = new ClienteDAO();
            clienteSelecionado = clienteDAO.buscarPorId(idCliente);

            txtNomeCliente.setText(clienteSelecionado.getNome());
            txtCpfCliente.setText(clienteSelecionado.getCpf()); 
            txtEmailCliente.setText(clienteSelecionado.getContato().getEmail());
            txtTelefoneCliente.setText(clienteSelecionado.getContato().getTelefone());

            btnSalvarCliente.setText("Atualizar");

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Erro ao carregar cliente: " + e.getMessage());
        }

    }//GEN-LAST:event_btnEditarClienteActionPerformed

    private void btnSalvarClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarClienteActionPerformed
        try {
            if (txtNomeCliente.getText().trim().isEmpty() || txtCpfCliente.getText().trim().isEmpty()) {
                JOptionPane.showMessageDialog(this, "Nome e CPF são Obrigatórios!");
                return;
            }

            Cliente cliente = new Cliente();
            Contato contato = new Contato();

            // Recupera IDs se for edição
            if(clienteSelecionado != null) {
                cliente.setId(clienteSelecionado.getId());
                contato.setId(clienteSelecionado.getContato().getId());
            }

            cliente.setEmpresa(usuarioLogado.getEmpresa());
            cliente.setNome(txtNomeCliente.getText());
            cliente.setCpf(txtCpfCliente.getText());

            contato.setEmail(txtEmailCliente.getText());
            contato.setTelefone(txtTelefoneCliente.getText());
            cliente.setContato(contato);


            if (clienteSelecionado == null) {
                clienteDAO.adicionar(cliente, usuarioLogado.getEmpresa().getId());
                JOptionPane.showMessageDialog(this, "Cliente cadastrado! (Adicione endereços com duplo clique na tabela)");
            } else {
                clienteDAO.atualizar(cliente);
                JOptionPane.showMessageDialog(this, "Cliente atualizado!");
            }

            limparFormularioCliente();
            atualizarTabelaClientes();
            preencherCombosOS();

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "ERRO ao salvar: " + e.getMessage());
        }

    }//GEN-LAST:event_btnSalvarClienteActionPerformed

    private void btnImprimirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImprimirActionPerformed
                                                     
        try {
            Connection con = Conexao.getConexao();

            // Parâmetros do relatório
            Map<String, Object> parametro = new HashMap<>();
            parametro.put("id_empresa", usuarioLogado.getEmpresa().getId()); 
            // Se for relatório de OS específica:
            // params.put("id_os", idDaOsSelecionada);

            // Caminho do arquivo .jasper
            String caminho = "src/main/resources/relatorios/relatorioOS.jasper";

            RelatorioUtil.abrirPDF(caminho, parametro, con);

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, "Erro ao gerar relatório: " + e.getMessage());
        }

    }//GEN-LAST:event_btnImprimirActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ReflectiveOperationException | javax.swing.UnsupportedLookAndFeelException ex) {
            logger.log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(() -> new Principal().setVisible(true));
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JFormattedTextField FtdDataEntradaOS;
    private Componentes.RoundedButton btnEditarCliente;
    private Componentes.RoundedButton btnEditarOS;
    private Componentes.RoundedButton btnEditarTecnico;
    private Componentes.RoundedButton btnExcluirCliente;
    private Componentes.RoundedButton btnExcluirOS;
    private Componentes.RoundedButton btnExcluirTecnico;
    private Componentes.IconButton btnFechar;
    private Componentes.RoundedButton btnImprimir;
    private Componentes.IconButton btnMinimizar;
    private Componentes.RoundedButton btnSair;
    private Componentes.RoundedButton btnSalvarCliente;
    private Componentes.RoundedButton btnSalvarOS;
    private Componentes.RoundedButton btnSalvarTecnico;
    private javax.swing.JComboBox<Object> cbxClienteOS;
    private javax.swing.JComboBox<String> cbxEspecialidade;
    private javax.swing.JComboBox<String> cbxStatus;
    private javax.swing.JComboBox<Object> cbxTecnicoOS;
    private javax.swing.JFormattedTextField ftdDataSaidaOS;
    private Componentes.IconButton iconButton1;
    private Componentes.IconButton iconButton3;
    private Componentes.ImagePanel imagePanel1;
    private Componentes.ImagePanel imagePanel2;
    private Componentes.ImagePanel imagePanel3;
    private Componentes.ImagePanel imagePanel4;
    private Componentes.ImagePanel imagePanel6;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel lblTotalAbertas;
    private javax.swing.JLabel lblTotalAndamento;
    private javax.swing.JLabel lblTotalCanceladas;
    private javax.swing.JLabel lblTotalConcluidas;
    private javax.swing.JLabel lblValorPendente;
    private javax.swing.JLabel lblValorTotal;
    private Componentes.MaterialTableBeanInfo materialTableBeanInfo1;
    private javax.swing.JPanel panelGraficoTotalStatus;
    private javax.swing.JPanel panelGraficoTotalValor;
    private javax.swing.JPasswordField pwdSenhaTecnico;
    private Componentes.RoundedPanel roundedPanel1;
    private Componentes.RoundedPanel roundedPanel10;
    private Componentes.RoundedPanel roundedPanel11;
    private Componentes.RoundedPanel roundedPanel12;
    private Componentes.RoundedPanel roundedPanel13;
    private Componentes.RoundedPanel roundedPanel14;
    private Componentes.RoundedPanel roundedPanel2;
    private Componentes.RoundedPanel roundedPanel3;
    private Componentes.RoundedPanel roundedPanel5;
    private Componentes.RoundedPanel roundedPanel6;
    private Componentes.RoundedPanel roundedPanel7;
    private Componentes.RoundedPanel roundedPanel8;
    private Componentes.RoundedPanel roundedPanel9;
    private javax.swing.JTable tblCliente;
    private javax.swing.JTable tblRelatorioOS;
    private javax.swing.JTable tblTecnico;
    private javax.swing.JTextArea txaProblemaOS;
    private Componentes.TextField txtCpfCliente;
    private Componentes.TextField txtEmailCliente;
    private Componentes.TextField txtEmailTecnico;
    private Componentes.TextField txtNomeCliente;
    private Componentes.TextField txtNomeTecnico;
    private Componentes.TextField txtTelefoneCliente;
    private Componentes.TextField txtTelefoneTecnico;
    private Componentes.TextField txtValorMaoDeObraOS;
    private Componentes.TextField txtValorPecasOS;
    private Componentes.TextField txtValorTotalOS;
    // End of variables declaration//GEN-END:variables


    private void aplicarPermissoes() {
        if (usuarioLogado != null && "tecnico".equalsIgnoreCase(usuarioLogado.getRole())) {
            if (jTabbedPane1.getTabCount() > 3) jTabbedPane1.setEnabledAt(3, false);
            if (jTabbedPane1.getTabCount() > 1) jTabbedPane1.setEnabledAt(1, false);
        }
    }
    
    
    private void preencherCombosOS() throws SQLException {
        if (usuarioLogado == null) return;
        int idEmpresa = usuarioLogado.getEmpresa().getId();
        
        cbxClienteOS.removeAllItems();
        for (Cliente c : clienteDAO.listarTodos(idEmpresa)) {
            cbxClienteOS.addItem(c);
        }
        
        cbxTecnicoOS.removeAllItems();
        cbxTecnicoOS.addItem(null);
        for (Tecnico t : tecnicoDAO.listarTodos(idEmpresa)){
            cbxTecnicoOS.addItem(t);
        }
    }
    
    private void atualizarTabelaOS() {
        if (usuarioLogado == null) return;
        
        DefaultTableModel modelo = (DefaultTableModel) tblRelatorioOS.getModel();
        modelo.setNumRows(0);
        
        try {
            int idEmpresa = usuarioLogado.getEmpresa().getId();
            List<OrdemServico> lista = osDAO.listarTabelaOS(idEmpresa);
            
            for (OrdemServico os : lista){
                modelo.addRow(new Object[]{
                    os.getId(),
                    os.getCliente().getNome(),
                    (os.getTecnico() != null ? os.getTecnico().getNome() : "Sem Técnico"),
                    os.getStatus(),
                    "R$ " + os.getValorTotal()
                }); 
            }
        } catch (SQLException e){
            JOptionPane.showMessageDialog(this, "ERRO ao listar Os: " + e.getMessage());
        }
    }
    
    private void limparFormulariosOS() {
        osSelecionada = null;
        cbxClienteOS.setSelectedIndex(-1);
        cbxTecnicoOS.setSelectedIndex(-1);
        cbxStatus.setSelectedIndex(0);
        txaProblemaOS.setText("");
        txtValorMaoDeObraOS.setText("0.00");
        txtValorTotalOS.setText("0.00");
        txtValorPecasOS.setText("0.00");
        if (FtdDataEntradaOS != null) FtdDataEntradaOS.setText(sdf.format(new Date()));
        if (ftdDataSaidaOS != null) ftdDataSaidaOS.setText("");
        btnSalvarOS.setText("salvar");
    }
    
    private void atualizarTabelaClientes() {
        if (usuarioLogado == null) return;
        
        DefaultTableModel modelo = (DefaultTableModel) tblCliente.getModel();
        modelo.setNumRows(0);
        
        try {
            int idEmpresa = usuarioLogado.getEmpresa().getId();
            listaClientes = clienteDAO.listarTodos(idEmpresa);
            
            for (Cliente c : listaClientes) {
                modelo.addRow(new Object[]{
                    c.getId(),
                    c.getNome(),
                    c.getContato().getTelefone(),
                    c.getContato().getEmail(),
                    c.getEndereco().getEstado(),
                    c.getEndereco().getCidade()
                });
            }
        } catch (SQLException e){
            JOptionPane.showMessageDialog(this, "ERRO ao listar Clientes: " + e.getMessage());   
        }
    }
    
    private void limparFormularioCliente(){
        clienteSelecionado = null;
        
        //dados pessoais
        txtNomeCliente.setText("");
        txtEmailCliente.setText("");
        txtTelefoneCliente.setText("");
        txtCpfCliente.setText("");
        
     
        // reseta Botão
        btnSalvarCliente.setText("Salvar");
        
    }

    private void atualizarTabelaTecnico() {
        if (usuarioLogado == null) return;
        
        DefaultTableModel modelo = (DefaultTableModel) tblTecnico.getModel();
        modelo.setNumRows(0);
        
        try {
            int idEmpresa = usuarioLogado.getEmpresa().getId();
            
            //guarda lista em memoria para edição
            listaTecnicos = tecnicoDAO.listarTodos(idEmpresa);
            
            for (Tecnico t : listaTecnicos) {
                modelo.addRow(new Object[]{
                    t.getId(),
                    t.getNome(),
                    t.getContato().getTelefone(),
                    t.getContato().getEmail(),
                    t.getEspecialidade()
                });
            }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this, "ERRO ao listar Técnicos: " + e.getMessage());
        }
    }
    
    private void limparFormularioTecnico() {
        tecnicoSelecionado = null;
        
        //Dados Pessoais
        txtNomeTecnico.setText("");
        txtEmailTecnico.setText("");
        txtTelefoneTecnico.setText("");
        
        if (pwdSenhaTecnico != null) pwdSenhaTecnico.setText("");
        
        if (cbxEspecialidade.getItemCount() > 0) cbxEspecialidade.setSelectedIndex(0);
        
        //reseta Botão
        btnSalvarTecnico.setText("Salvar");
    }
    
    public void atualizarRelatorios(){
        if (usuarioLogado == null) return;
        
        try {
            int idEmpresa = usuarioLogado.getEmpresa().getId();
            
            //chama o metodo do dao
            double[] dados = osDAO.carregarDadosRelatorio(idEmpresa);
            
            //formatacao para dinheiro
            java.text.NumberFormat nf = java.text.NumberFormat.getCurrencyInstance(new java.util.Locale("pt", "BR"));
        
            //Preencher as Labels
            lblTotalAbertas.setText(String.valueOf((int)dados[0]));
            lblTotalAndamento.setText(String.valueOf((int)dados[1]));
            lblTotalConcluidas.setText(String.valueOf((int)dados[2]));
            lblTotalCanceladas.setText(String.valueOf((int) dados[5]));
            
            valorTotalOS = dados[3];
            valorPendenteOS = dados[4];
            
            lblValorTotal.setText(nf.format(valorTotalOS));
            lblValorPendente.setText(nf.format(valorPendenteOS));
            
        } catch (Exception e) {
            System.out.println("ERRO ao atualizar relatorios: " + e.getMessage());
        }
    }
    
    
    
    
    public void gerarGraficoStatusOS() {

        int abertas     = Integer.parseInt(lblTotalAbertas.getText());
        int andamento   = Integer.parseInt(lblTotalAndamento.getText());
        int concluidas  = Integer.parseInt(lblTotalConcluidas.getText());
        int canceladas  = Integer.parseInt(lblTotalCanceladas.getText());

        DefaultPieDataset dataset = new DefaultPieDataset();
        dataset.setValue("Abertas", abertas);
        dataset.setValue("Em Andamento", andamento);
        dataset.setValue("Concluídas", concluidas);
        dataset.setValue("Canceladas", canceladas);

        JFreeChart chart = ChartFactory.createPieChart(
            "Distribuição das O.S por Status",
            dataset,
            true,
            true,
            false
        );

        ChartPanel chartPanel = new ChartPanel(chart);
        chartPanel.setMouseWheelEnabled(true);
        chartPanel.setPreferredSize(panelGraficoTotalValor.getSize());

        panelGraficoTotalStatus.removeAll();
        panelGraficoTotalStatus.setLayout(new BorderLayout());
        panelGraficoTotalStatus.add(chartPanel, BorderLayout.CENTER);
        panelGraficoTotalStatus.revalidate();
        panelGraficoTotalStatus.repaint();
    }
    
    public void gerarGraficoValoresOS() {

        // Função segura para converter "R$ 1.234,56" → double
        Function<String, Double> parseValor = (txt) -> {
            try {
                return Double.parseDouble(
                    txt.replace("R$", "")
                       .replace(".", "")
                       .replace(",", ".")
                       .trim()
                );
            } catch (Exception e) {
                return 0.0;
            }
        };


        DefaultPieDataset dataset = new DefaultPieDataset();
        dataset.setValue("Valor Total", valorTotalOS);
        dataset.setValue("Valor Pendente", valorPendenteOS);
        
        System.out.println("TOTAL: " + valorTotalOS);
        System.out.println("PENDENTE: " + valorPendenteOS);


        JFreeChart chart = ChartFactory.createPieChart(
            "Distribuição Financeira das O.S",
            dataset,
            true,
            true,
            false
        );

        ChartPanel chartPanel = new ChartPanel(chart);
        chartPanel.setMouseWheelEnabled(true);
        chartPanel.setPreferredSize(panelGraficoTotalValor.getSize());

        panelGraficoTotalValor.removeAll();
        panelGraficoTotalValor.setLayout(new BorderLayout());
        panelGraficoTotalValor.add(chartPanel, BorderLayout.CENTER);
        panelGraficoTotalValor.revalidate();
        panelGraficoTotalValor.repaint();
    }



}
